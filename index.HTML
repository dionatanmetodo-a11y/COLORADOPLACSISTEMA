<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Colorado Plac</title>
  <!-- Bibliotecas jsPDF e autoTable -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 30px;
      background: #add8e6; /* azul claro */
    }

    /* Caixas principais */
    .section {
      background: rgba(255, 255, 255, 0.9); /* branco transl√∫cido */
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    h1, h2 {
      color: #333;
    }

    label {
      display: block;
      margin-top: 10px;
    }

    input, select, button, textarea {
      padding: 8px;
      margin-top: 5px;
      width: 100%;
      max-width: 500px;
    }

    /* Estilo da tabela */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
      background: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    table thead {
      background: #007BFF; /* azul */
      color: white;
    }

    table th, table td {
      padding: 12px;
      text-align: left;
      border: 1px solid #ddd;
    }

    table tbody tr:nth-child(even) {
      background: #e6f2ff;
    }

    table tbody tr:nth-child(odd) {
      background: #ffffff;
    }

    table tbody tr:hover {
      background: #cce5ff;
    }

    .success {
      color: green;
      margin-top: 10px;
    }

    /* Bot√µes azuis */
    button, .pdf-button, .clear-button {
      background: #007BFF;
      color: white;
      font-weight: bold;
      border: none;
      padding: 10px 20px;
      cursor: pointer;
      border-radius: 8px;
      transition: background 0.3s;
      max-width: 200px;
    }

    button:hover, .pdf-button:hover, .clear-button:hover {
      background: #0056b3;
    }
  </style>
</head>
<body>

  <h1>üìä Colorado Plac</h1>

  <!-- Adicionar Cidade -->
  <div class="section">
    <h2>Adicionar Cidade</h2>
    <label for="cidade">Nome da Cidade:</label>
    <input type="text" id="cidade" placeholder="Ex: Porto Alegre" />
    <button onclick="adicionarCidade()">Adicionar Cidade</button>
    <div id="cidadeMsg" class="success"></div>
  </div>

  <!-- Registrar Venda -->
  <div class="section">
    <h2>Registrar Venda</h2>

    <label for="cidadeVenda">Cidade:</label>
    <select id="cidadeVenda"></select>

    <label for="cliente">Nome do Cliente:</label>
    <input type="text" id="cliente" placeholder="Ex: Jo√£o da Loja XYZ" />

    <label for="item">Item Vendido:</label>
    <select id="item">
      <option value="">-- Selecione o item --</option>
      <option value="Placa">Placa</option>
      <option value="Lixeira">Lixeira</option>
      <option value="Banco">Banco</option>
    </select>

    <label for="quantidade">Quantidade:</label>
    <select id="quantidade">
      <option value="">-- Selecione a quantidade --</option>
    </select>

    <label for="valor">Valor Total (R$):</label>
    <input type="number" id="valor" placeholder="Ex: 450.00" min="0" step="0.01" />

    <label for="forma">Forma de Pagamento:</label>
    <select id="forma">
      <option value="Pix">Pix</option>
      <option value="Dinheiro">Dinheiro</option>
      <option value="Boleto">Boleto</option>
      <option value="Cart√£o">Cart√£o</option>
    </select>

    <label for="pontos">Pontos de Instala√ß√£o:</label>
    <textarea id="pontos" placeholder="Ex: Pra√ßa Central, Escola Municipal, Rua das Flores" rows="3"></textarea>

    <button onclick="registrarVenda()">Salvar Venda</button>
    <div id="vendaMsg" class="success"></div>
  </div>

  <!-- Vendas Registradas -->
  <div class="section">
    <h2>Vendas Registradas</h2>
    <table id="tabelaVendas">
      <thead>
        <tr>
          <th>Cidade</th>
          <th>Cliente</th>
          <th>Item</th>
          <th>Qtd</th>
          <th>Valor (R$)</th>
          <th>Forma</th>
          <th>Pontos de Instala√ß√£o</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <!-- Bot√µes -->
    <button class="pdf-button" onclick="gerarPDF()">Gerar PDF</button>
    <button class="clear-button" onclick="limparPlanilha()">Limpar Planilha</button>
  </div>

  <script>
    let cidades = [];
    let vendas = [];

    // Popula o select quantidade com valores de 1 a 50
    const selectQtd = document.getElementById('quantidade');
    for(let i=1; i<=50; i++) {
      const option = document.createElement('option');
      option.value = i;
      option.textContent = i;
      selectQtd.appendChild(option);
    }

    // ---- Fun√ß√µes de persist√™ncia ----
    function salvarLocal() {
      localStorage.setItem("cidades", JSON.stringify(cidades));
      localStorage.setItem("vendas", JSON.stringify(vendas));
    }

    function carregarLocal() {
      const cidadesSalvas = localStorage.getItem("cidades");
      const vendasSalvas = localStorage.getItem("vendas");

      if (cidadesSalvas) cidades = JSON.parse(cidadesSalvas);
      if (vendasSalvas) vendas = JSON.parse(vendasSalvas);

      atualizarCidades();
      atualizarTabela();
    }

    function adicionarCidade() {
      const nome = document.getElementById('cidade').value.trim();
      const msg = document.getElementById('cidadeMsg');
      msg.innerText = '';

      if (nome === '') {
        alert("Digite o nome da cidade.");
        return;
      }

      if (cidades.includes(nome)) {
        alert("Cidade j√° cadastrada.");
        return;
      }

      cidades.push(nome);
      salvarLocal();
      atualizarCidades();
      document.getElementById('cidade').value = '';
      msg.innerText = 'Cidade adicionada com sucesso!';
    }

    function atualizarCidades() {
      const select = document.getElementById('cidadeVenda');
      select.innerHTML = '';

      cidades.forEach(cidade => {
        const option = document.createElement('option');
        option.value = cidade;
        option.textContent = cidade;
        select.appendChild(option);
      });
    }

    function registrarVenda() {
      const cidade = document.getElementById('cidadeVenda').value;
      const cliente = document.getElementById('cliente').value.trim();
      const item = document.getElementById('item').value;
      const quantidade = parseInt(document.getElementById('quantidade').value);
      const valor = parseFloat(document.getElementById('valor').value);
      const forma = document.getElementById('forma').value;
      const pontos = document.getElementById('pontos').value.trim();
      const msg = document.getElementById('vendaMsg');
      msg.innerText = '';

      if (!cidade || !cliente || !item || isNaN(quantidade) || quantidade <= 0 || isNaN(valor) || valor <= 0 || !pontos) {
        alert("Preencha todos os campos corretamente.");
        return;
      }

      const venda = { cidade, cliente, item, quantidade, valor, forma, pontos };

      vendas.push(venda);
      salvarLocal();
      atualizarTabela();

      // Limpar campos
      document.getElementById('cliente').value = '';
      document.getElementById('item').value = '';
      document.getElementById('quantidade').value = '';
      document.getElementById('valor').value = '';
      document.getElementById('pontos').value = '';
      msg.innerText = 'Venda registrada com sucesso!';
    }

    function atualizarTabela() {
      const tbody = document.getElementById('tabelaVendas').querySelector('tbody');
      tbody.innerHTML = '';

      vendas.forEach(venda => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${venda.cidade}</td>
          <td>${venda.cliente}</td>
          <td>${venda.item}</td>
          <td>${venda.quantidade}</td>
          <td>${venda.valor.toFixed(2)}</td>
          <td>${venda.forma}</td>
          <td>${venda.pontos}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    // Fun√ß√£o para gerar PDF
    function gerarPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      doc.setFontSize(14);
      doc.text("Relat√≥rio de Vendas - Colorado Plac", 14, 15);

      const colunas = ["Cidade", "Cliente", "Item", "Qtd", "Valor (R$)", "Forma", "Pontos"];
      const linhas = vendas.map(v => [
        v.cidade,
        v.cliente,
        v.item,
        v.quantidade,
        v.valor.toFixed(2),
        v.forma,
        v.pontos
      ]);

      doc.autoTable({
        head: [colunas],
        body: linhas,
        startY: 20,
        styles: { fontSize: 10 },
        headStyles: { fillColor: [52, 58, 64] }
      });

      doc.save("vendas_ColoradoPlac.pdf");
    }

    // Fun√ß√£o para limpar tudo
    function limparPlanilha() {
      if (confirm("Tem certeza que deseja limpar TODAS as cidades e vendas?")) {
        cidades = [];
        vendas = [];
        localStorage.removeItem("cidades");
        localStorage.removeItem("vendas");
        atualizarCidades();
        atualizarTabela();
        alert("Planilha limpa com sucesso!");
      }
    }

    // carregar dados salvos ao abrir a p√°gina
    window.onload = carregarLocal;
  </script>
</body>
</html>
